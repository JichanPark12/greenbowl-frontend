"use client";

import { useGSAP } from "@gsap/react";
import gsap from "gsap";
import { useRef } from "react";

gsap.registerPlugin(useGSAP);

const DrinkingCharacter = ({ isPlay }: { isPlay: boolean }) => {
  const ref = useRef<SVGSVGElement>(null);

  useGSAP(
    () => {
      const tl = gsap.timeline({ repeat: -1, delay: 0.5, paused: true });
      tl.to("#drinkFace", {
        rotation: 20,
        transformOrigin: "bottom center",
        duration: 0.8,
      });
      tl.to(
        "#waterAndArm",
        {
          rotation: 20,
          transformOrigin: "bottom right",
          duration: 0.8,
        },
        0
      );
      tl.to(
        "#waterDropBox",
        {
          rotation: 20,
          transformOrigin: "center",
          duration: 0.8,
        },
        0
      );

      tl.to("#drinkFace", {
        rotation: 0,
        transformOrigin: "bottom center",
        duration: 0.4,
      });
      tl.to(
        "#waterAndArm",
        {
          rotation: 0,
          transformOrigin: "bottom right",
          duration: 0.4,
        },
        "<0"
      );

      tl.to(
        "#waterDrop1",
        {
          x: -10,
          rotation: -40,
          scale: 0,
          duration: 0.4,
        },
        0
      );
      tl.to(
        "#waterDrop2",
        {
          x: -10,
          rotation: -40,
          scale: 0,
          duration: 0.4,
        },
        0
      );
      if (!isPlay) {
        tl.pause(0);
      }
      if (isPlay) {
        tl.play();
      }
    },
    { scope: ref, dependencies: [isPlay], revertOnUpdate: true }
  );

  return (
    <svg
      width="168"
      height="168"
      viewBox="0 0 168 168"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      ref={ref}
    >
      <g mask="url(#mask0_866_41260)">
        <path
          d="M111.091 110.952C111.091 125.402 100.131 130.842 86.8913 130.842C73.6513 130.842 68.0312 124.632 68.0312 110.182C68.0312 95.7317 78.7613 84.0117 92.0013 84.0117C105.241 84.0117 111.091 96.5017 111.091 110.962V110.952Z"
          fill="#C6D68F"
        />

        <g id="waterAndArm">
          <path
            d="M37.6599 94.8115L30.9899 89.9515C29.9899 89.2115 29.6999 87.8415 30.3399 86.7715L41.9099 67.3515C42.6399 66.1315 44.2499 65.8115 45.3999 66.6415L55.4399 73.9615C56.5799 74.7915 56.7699 76.4415 55.8299 77.5015L40.8899 94.4715C40.0699 95.4015 38.6699 95.5515 37.6599 94.8315H37.6499L37.6599 94.8115Z"
            fill="#FFFFEA"
          />
          <path
            id="water"
            d="M54.1009 75.9716L39.1609 92.9216L39.0809 92.9516C39.0809 92.9516 39.0309 92.9416 39.0209 92.9416L32.3509 88.0816C32.3509 88.0816 32.2909 87.9916 32.3209 87.9416L35.4109 82.7716L35.4909 82.6316C40.4909 80.7616 49.5409 77.5016 54.0909 75.8516V75.9716H54.1009Z"
            fill="#B6CBDB"
          />
          <path
            id="arm"
            d="M104.742 97.0183C104.742 97.0183 55.5516 113.768 52.3516 84.4883"
            stroke="#C6D68F"
            strokeWidth="14.75"
            strokeLinecap="round"
          />
        </g>
        <path
          d="M91.0938 127.801V144.051"
          stroke="#C6D68F"
          strokeWidth="13.83"
          strokeLinecap="round"
        />
        <path
          d="M81.8516 119.199V135.449"
          stroke="#C6D68F"
          strokeWidth="13.83"
          strokeLinecap="round"
        />
        <g id="drinkFace">
          <path
            d="M65.0889 57.6996C64.6589 59.3496 63.3689 60.2796 61.9889 59.9096C60.6089 59.5596 59.8289 57.9296 60.2589 56.2896C60.6689 54.6396 62.1489 53.5896 63.5189 53.9496H63.5289C64.8989 54.2996 65.4989 56.0496 65.0889 57.6996Z"
            fill="#C6D68F"
          />
          <path
            d="M133.428 76.1502C130.758 87.2402 124.438 94.5402 115.978 98.2002C108.478 101.44 99.5484 101.69 90.4984 99.6102C89.4984 99.3802 88.4984 99.1302 87.4984 98.8402C82.0284 97.2802 76.9184 95.0102 72.5084 92.0402C72.1184 91.8002 71.7484 91.5202 71.3684 91.2602C71.8084 91.3502 72.2384 91.4202 72.6784 91.4702C83.6884 92.7702 94.2584 83.0102 96.8784 66.1502C99.4784 49.2702 92.6884 34.5602 81.6884 33.2602C75.0884 32.4802 67.7784 36.5402 62.4084 43.5802C61.8884 44.2502 61.3784 44.9602 60.8984 45.7002C61.2084 45.0902 61.5284 44.4802 61.8584 43.8902C62.9284 41.9502 64.1384 40.1402 65.4784 38.4402C69.5784 33.2602 74.1984 28.4202 79.1584 24.0902C86.8484 17.3602 96.8084 14.2602 106.688 17.0702C115.588 19.5902 122.358 26.3602 126.318 34.9202C129.388 41.5602 131.768 48.5802 133.448 55.6302C135.038 62.1902 135.138 69.2102 133.448 76.1702L133.428 76.1502Z"
            fill="#C6D68F"
          />
          <path
            d="M98.4913 66.1318C95.7513 82.9918 84.7113 92.7518 73.2013 91.4518C72.7413 91.4018 72.2913 91.3318 71.8313 91.2418C69.1013 90.7218 66.4813 89.5618 64.1413 87.8718C60.6813 85.3318 57.8513 81.6518 56.1313 77.0618C56.1313 77.0518 56.1213 77.0518 56.1213 77.0418C53.9513 72.5918 54.5313 62.8818 54.5313 62.8818C54.5913 62.2618 54.6813 61.6418 54.7813 61.0018C55.7013 55.2318 57.9313 49.9918 60.8913 45.6718C61.4013 44.9318 61.9313 44.2218 62.4713 43.5518C68.0813 36.5218 75.7213 32.4518 82.6213 33.2318C94.1113 34.5318 101.211 49.2418 98.4913 66.1218V66.1318Z"
            fill="#F4F4E0"
          />
          <path
            d="M59.5037 72.8994C61.2537 72.8994 62.6637 70.5394 62.6637 67.6294C62.6637 64.7194 61.2437 62.3594 59.5037 62.3594C57.7637 62.3594 56.3438 64.7194 56.3438 67.6294C56.3438 70.5394 57.7637 72.8994 59.5037 72.8994Z"
            fill="#464641"
          />
          <path
            d="M68.4297 55.6211C69.0397 56.9111 70.8197 59.5911 73.0197 60.0311"
            stroke="#44443F"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path
            d="M60.8234 53.2812C59.3334 54.5013 59.1334 55.2813 57.0234 54.5013"
            stroke="#44443F"
            strokeWidth="2"
            strokeLinecap="round"
          />
        </g>
      </g>
      <g id="waterDropBox">
        <path
          id="waterDrop1"
          d="M39.8531 56.9776C39.3331 56.7876 38.9131 56.5276 38.6331 55.8876C38.3131 55.1376 38.3331 54.2176 38.7631 53.5076C39.3931 52.4676 40.8331 51.9976 41.9531 52.4776C42.6631 52.7776 43.2031 53.3876 43.6331 54.0276C44.8131 55.7976 45.3231 57.9076 45.8131 59.9676C44.4031 58.5976 42.5531 57.8476 40.7131 57.2476C40.4031 57.1476 40.1031 57.0676 39.8431 56.9676L39.8531 56.9776Z"
          fill="#B6CBDB"
        />
        <path
          id="waterDrop2"
          d="M40.8991 62.5693C40.6191 62.6493 40.3591 62.6793 40.0491 62.4993C39.6791 62.2893 39.3991 61.8893 39.3491 61.4593C39.2891 60.8193 39.7391 60.1793 40.3591 60.0193C40.7491 59.9193 41.1691 60.0093 41.5591 60.1393C42.6091 60.5093 43.4891 61.2293 44.3491 61.9393C43.3291 61.8093 42.3091 62.0793 41.3591 62.4093C41.1991 62.4693 41.0491 62.5293 40.9091 62.5693H40.8991Z"
          fill="#B6CBDB"
        />
      </g>
    </svg>
  );
};

export default DrinkingCharacter;
