"use client";

import { useGSAP } from "@gsap/react";
import gsap from "gsap";
import { useRef } from "react";

gsap.registerPlugin(useGSAP);

const ReadingCharacter = ({ isPlay }: { isPlay: boolean }) => {
  const ref = useRef<SVGSVGElement>(null);
  useGSAP(
    () => {
      const $books = [...document.querySelectorAll(".book")].toSorted(
        (a, b) => {
          const numberA = +a.classList[1];
          const numberB = +b.classList[1];

          return numberB - numberA;
        }
      );
      const tl = gsap.timeline({ repeat: -1, repeatDelay: 2 });
      $books.forEach((book, idx) => {
        const stagger = idx === 0 ? "<+0" : "<+0.3";
        tl.fromTo(
          book,
          { y: -40 },
          { y: 0, duration: 0.8, ease: "bounce.out" },
          stagger
        );
        gsap.to("#eyes", {
          x: -3,
          duration: 1,
          repeat: -1,
          yoyo: true,
          repeatDelay: 0.5,
        });
      });
      if (!isPlay) {
        tl.pause(0);
      }
      if (isPlay) {
        tl.play();
      }
    },
    { scope: ref, dependencies: [isPlay], revertOnUpdate: true }
  );
  return (
    <svg
      width="168"
      height="168"
      viewBox="0 0 168 168"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      ref={ref}
    >
      <path
        d="M114.721 100.331C117.831 113.881 108.181 122.221 94.6315 125.331C81.0815 128.441 68.7615 125.141 65.6515 111.591C62.5415 98.041 71.0015 84.531 84.5515 81.421C98.1015 78.311 111.611 86.771 114.721 100.321V100.331Z"
        fill="#C0D68B"
      />
      <path
        d="M71 109C72.66 126.84 101.5 128 109.5 128.5"
        stroke="#C0D68B"
        strokeWidth="9.76"
        strokeLinecap="round"
      />
      <path
        d="M93 101C94.66 118.84 116.3 118.73 124.03 118.34"
        stroke="#C0D68B"
        strokeWidth="9.76"
        strokeLinecap="round"
      />
      <path
        d="M124.96 75.7808C123.87 86.5608 118.79 94.3308 111.17 98.9708C104.41 103.091 95.9 104.611 86.94 103.961C85.95 103.891 84.96 103.791 83.97 103.671C78.52 103.001 73.34 101.611 68.72 99.4608C64.83 97.6608 61.32 95.3208 58.38 92.4408C51.88 86.0608 48.47 77.2508 49.56 66.4508C50.17 60.4808 52.04 54.9608 54.88 50.1808C58.11 44.7408 61.89 39.5308 66.07 34.7508C72.54 27.3408 81.67 22.9908 91.52 24.2008C100.36 25.2908 107.75 30.6508 112.68 38.1108C116.5 43.9008 119.71 50.1508 122.26 56.5208C124.64 62.4408 125.67 69.0208 124.98 75.7908L124.96 75.7808Z"
        fill="#C0D68B"
      />
      <path
        d="M122.269 74.5593C122.319 87.9193 111.009 96.5093 96.9992 96.5393C82.9892 96.5793 71.5992 88.0393 71.5392 74.6893C71.4892 61.3293 82.7892 50.4793 96.7992 50.4493C110.819 50.4093 122.209 61.2093 122.269 74.5693V74.5593Z"
        fill="#F3F3DF"
      />
      <path
        d="M95.4575 97.91L96.0275 91.05C96.0275 91.05 109.687 90.53 111.997 94.73C111.997 94.73 120.228 88.88 124.148 88.93L123.678 108.01L113.958 115.03L96.2375 111.73L95.4375 97.9L95.4575 97.91Z"
        fill="#E4F0D9"
      />
      <path
        d="M97.0773 93.1587C101.677 93.3087 108.597 93.9087 111.047 96.0687L109.707 116.859C109.707 116.859 102.217 115.159 96.8673 114.469C94.2273 114.129 92.2773 111.859 92.3373 109.199L92.6173 97.3787C92.6773 94.9787 94.6673 93.0787 97.0673 93.1587H97.0773Z"
        fill="#70B56D"
      />
      <path
        d="M126.564 89.1286C122.464 90.7686 116.644 93.4386 114.734 95.9686L116.474 115.509C116.474 115.509 120.704 111.479 124.474 109.779C126.244 108.979 127.534 107.409 127.854 105.499L130.104 91.9986C130.444 89.9886 128.444 88.3686 126.554 89.1286H126.564Z"
        fill="#70B56D"
      />
      <path
        d="M110.82 95.7916L109.07 115.662C108.95 117.022 110.32 118.092 111.89 117.862L113.86 117.582C115.74 117.312 117.1 115.832 116.97 114.212L115.41 95.4116C115.36 94.8616 114.8 94.4616 114.15 94.5216L112.02 94.7416C111.38 94.8016 110.88 95.2516 110.83 95.8016L110.82 95.7916Z"
        fill="#70B56D"
      />
      <path
        d="M98.5175 106.699C98.5175 106.699 94.3175 112.649 82.6875 103.449"
        stroke="#C0D68B"
        strokeWidth="9.76"
        strokeLinecap="round"
      />
      <path
        d="M94.3193 103.05C94.3193 103.05 89.7094 105.34 83.6094 101.27"
        stroke="#70B56D"
        strokeWidth="0.75"
        strokeLinecap="round"
      />
      <path
        d="M128.546 107.38C126.376 107.48 125.586 105.75 125.486 103.58C125.386 101.41 126.026 99.6199 128.196 99.5199C130.366 99.4199 132.206 101.1 132.296 103.28C132.386 105.46 130.716 107.29 128.536 107.38H128.546Z"
        fill="#C0D68B"
      />
      <path
        d="M102.461 87.2227C102.461 87.2227 105.691 89.2027 109.811 87.2227"
        stroke="#44443F"
        strokeWidth="2"
        strokeMiterlimit="10"
        strokeLinecap="round"
      />
      <g id="eyes">
        <path
          d="M99.4684 79.9092C100.474 79.9092 101.288 78.9108 101.288 77.6792C101.288 76.4476 100.474 75.4492 99.4684 75.4492C98.4633 75.4492 97.6484 76.4476 97.6484 77.6792C97.6484 78.9108 98.4633 79.9092 99.4684 79.9092Z"
          fill="#44443F"
        />
        <path
          d="M112.578 79.9092C113.583 79.9092 114.398 78.9108 114.398 77.6792C114.398 76.4476 113.583 75.4492 112.578 75.4492C111.573 75.4492 110.758 76.4476 110.758 77.6792C110.758 78.9108 111.573 79.9092 112.578 79.9092Z"
          fill="#44443F"
        />
      </g>

      <g id="books">
        <g className="book 1">
          <path
            d="M38.1719 117.422H67.0818C69.4718 117.422 71.4219 115.482 71.4219 113.082C71.4219 110.692 69.4818 108.742 67.0818 108.742H38.1719V117.412V117.422Z"
            fill="#EAF0E4"
          />
          <path
            d="M38.1719 117.422H67.0818C69.4718 117.422 71.4219 115.482 71.4219 113.082C71.4219 110.692 69.4818 108.742 67.0818 108.742H38.1719"
            stroke="#A5AF9C"
            strokeMiterlimit="10"
            strokeLinecap="round"
          />
        </g>

        <g className="book 4">
          <path
            d="M69.62 135.383H39.96C37.773 135.383 36 137.156 36 139.343V140.093C36 142.28 37.773 144.053 39.96 144.053H69.62C71.807 144.053 73.58 142.28 73.58 140.093V139.343C73.58 137.156 71.807 135.383 69.62 135.383Z"
            fill="#D5E0CB"
          />
        </g>
        <g className="book 3">
          <path
            d="M70.3203 135.801H41.4103C39.0203 135.801 37.0703 133.861 37.0703 131.461C37.0703 129.071 39.0103 127.121 41.4103 127.121H70.3203V135.791V135.801Z"
            fill="#E4F0D9"
          />
          <path
            d="M70.3203 135.801H41.4103C39.0203 135.801 37.0703 133.861 37.0703 131.461C37.0703 129.071 39.0103 127.121 41.4103 127.121H70.3203"
            fill="#EAF0E4"
          />
          <path
            d="M70.3203 135.801H41.4103C39.0203 135.801 37.0703 133.861 37.0703 131.461C37.0703 129.071 39.0103 127.121 41.4103 127.121H70.3203"
            stroke="#A5AF9C"
            strokeMiterlimit="10"
            strokeLinecap="round"
          />
        </g>
        <g className="book 2">
          <path
            d="M69.62 118.062H39.96C37.773 118.062 36 119.835 36 122.022V122.772C36 124.96 37.773 126.733 39.96 126.733H69.62C71.807 126.733 73.58 124.96 73.58 122.772V122.022C73.58 119.835 71.807 118.062 69.62 118.062Z"
            fill="#D5E0CB"
          />
        </g>
      </g>
    </svg>
  );
};

export default ReadingCharacter;
